<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Methodology, Key Considerations, and FAQs • correlationfunnel</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Methodology, Key Considerations, and FAQs">
<meta property="og:description" content="correlationfunnel">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-76139189-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-76139189-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">correlationfunnel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Function Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introducing_correlation_funnel.html">Introducing Correlation Funnel - Customer Churn Example</a>
    </li>
    <li>
      <a href="../articles/key_considerations.html">Key Considerations &amp; FAQs</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/business-science/correlationfunnel">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="key_considerations_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Methodology, Key Considerations, and FAQs</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/business-science/correlationfunnel/blob/master/vignettes/key_considerations.Rmd"><code>vignettes/key_considerations.Rmd</code></a></small>
      <div class="hidden name"><code>key_considerations.Rmd</code></div>

    </div>

    
    
<p>The purpose of the Methodology, Key Considerations, and FAQs is to address questions that users have regarding the <code>correlationfunnel</code> methodology and to highlight key considerations before or after various steps in <code>correlationfunnel</code> process.</p>
<p>Libraries used.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">correlationfunnel</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tibble</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">stringr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">forcats</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">knitr</span>)</pre></body></html></div>
<div id="methodology" class="section level2">
<h2 class="hasAnchor">
<a href="#methodology" class="anchor"></a>Methodology</h2>
<p>The method used is to perform <strong><em>binarization</em></strong>, the process of converting numeric and categorical variables to binary variables, and then to perform <strong><em>correlation analysis</em></strong> (Pearson method is used by default as the <code>corelate()</code> function wraps <code><a href="https://rdrr.io/r/stats/cor.html">stats::cor()</a></code>). This method lends itself well to quickly understanding relationships in data.</p>
<p>The Pearson correlation coefficient (see <a href="https://en.wikipedia.org/wiki/Phi_coefficient">phi coefficient</a>) measures the linear correlation between two dichotomous (binary) variables.</p>
<p><span class="math display">\[\phi = \frac{f_{11}*f_{00}-f_{01}*f_{10}}{\sqrt{(f_{11}+f_{01})*(f_{10}+f_{00})*(f_{00}+f_{01})*(f_{10}+f_{11})}}\]</span></p>
<p>Where from a Contingency Table,</p>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">y=0</th>
<th align="left">y=1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>x=0</td>
<td align="left">f00</td>
<td align="left">f01</td>
</tr>
<tr class="even">
<td>x=1</td>
<td align="left">f10</td>
<td align="left">f11</td>
</tr>
</tbody>
</table>
<p>Use of this method and tradeoffs are discussed at length herein and in L. Duan et al., 2014.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
</div>
<div id="key-considerations" class="section level2">
<h2 class="hasAnchor">
<a href="#key-considerations" class="anchor"></a>Key Considerations</h2>
<p>We recommend using the following best practices to get high performance with <code>correlationfunnel</code>:</p>
<div id="prior-to-binarization-step" class="section level3">
<h3 class="hasAnchor">
<a href="#prior-to-binarization-step" class="anchor"></a>Prior to Binarization Step</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Clean the Data</strong> - Make sure categorical data and numeric data are cleaned to take care of any errors and missing values.</p></li>
<li><p><strong>Perform Feature Engineering</strong> - Make sure useful information any text fields (e.g. description fields). Make sure date fields are converted to categorical data like day of the week. Use</p></li>
<li><p><strong>Discard Features Known to Have No Predictive Value</strong> - Example ID fields</p></li>
<li><p><strong>Discard ALL Non-Numeric and Non-Categorial Data</strong> - Remove date or datetime features, generic discription fields.</p></li>
<li>
<p><strong>Sample Data if Large</strong> - Performance could become slow on large data sets (Many Columns, Many Rows, and Many Category Levels within Categorical Columns).</p>
<ul>
<li>Use the <code>thresh_infreq</code> to limit the number of infrequently appearing categories</li>
<li>Sample the data to reduce the row number.</li>
<li>Run the Correlation Funnel, and select the best features.</li>
<li>Increase the rows with the best feature selections.</li>
<li>Re-run the Correlation Funnel on the shorter-width (columns), larger-height (rows) dataset.</li>
</ul>
</li>
</ol>
</div>
<div id="during-binarization" class="section level3">
<h3 class="hasAnchor">
<a href="#during-binarization" class="anchor"></a>During Binarization</h3>
<p>The <code><a href="../reference/binarize.html">binarize()</a></code> function performs the transformation from numeric/categorical data to binary data. Use the following parameters to ensure that the correlation step goes well.</p>
<ol style="list-style-type: decimal">
<li><p><strong>Specify Number of Bins (Numeric Data)</strong> - Use <code>n_bins</code> to control the number of bins that numeric data is binned into. Too many and data gets overly discrete. Too few and trend can be missed. Typically 4 or 5 bins is adequate.</p></li>
<li><p><strong>Eliminate Infrequent Categories (Categorical Data)</strong> - Use <code>thresh_infreq</code> to control the appearance of infrequent categories. This will speed up processing of the correlation and prevent dimensionality (width of columns) getting out of control. Typically 0.01 threshold is adequate.</p></li>
</ol>
</div>
<div id="prior-to-correlation-step" class="section level3">
<h3 class="hasAnchor">
<a href="#prior-to-correlation-step" class="anchor"></a>Prior to Correlation Step</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Address Data Imbalance</strong> - The correlation analysis is susceptible to data imbalance. Try reducing the number of majority class rows to get a proportion of 75% to 25% majority to minority class.</li>
</ol>
</div>
<div id="after-plotting-the-correlation-funnel" class="section level3">
<h3 class="hasAnchor">
<a href="#after-plotting-the-correlation-funnel" class="anchor"></a>After Plotting the Correlation Funnel</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Garbage In, Garbage Out</strong> - Using the <code>correlationfunnel</code> package on data that has little relationship will <em>not</em> yield good results. If you are not getting good results by following the afformentioned “Key Considerations”, then your data may have little relationship. This is useful and a sign that you may need to collect better data.</p></li>
<li><p><strong>Something Bad Happened or You Think Something Good Should Have Happened</strong> - File an error on <a href="https://github.com/business-science/correlationfunnel/issues">GitHub</a> if you have a question and you believe that <code>correlationfunnel</code> should be reporting something differently and/or has an error.</p></li>
</ol>
</div>
</div>
<div id="faqs" class="section level2">
<h2 class="hasAnchor">
<a href="#faqs" class="anchor"></a>FAQs</h2>
<div id="how-does-the-correlation-funnel-find-relationships-in-numeric-data" class="section level3">
<h3 class="hasAnchor">
<a href="#how-does-the-correlation-funnel-find-relationships-in-numeric-data" class="anchor"></a>1. How does the Correlation Funnel Find Relationships in Numeric Data?</h3>
<p>The approach to numeric data is to bin. This works well when non-linear relationships are present at the expense of a slight loss in linear relationship identification. We’ll see examples using synthetic data to illustrate this point.</p>
<div id="linear-relationships" class="section level4">
<h4 class="hasAnchor">
<a href="#linear-relationships" class="anchor"></a>1.1 Linear Relationships</h4>
<p>Let’s make some sample data for Sales versus a highly correlated Macroeconomic Predictor.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># Generate Data</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)
<span class="no">linear_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">tibble</a></span>(
  <span class="kw">sales</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">100</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">5</span>) + <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="fl">200</span>,<span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">100</span>) * <span class="fl">1e6</span>,
  <span class="kw">macro_indicator</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">100</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">2</span>) + <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">5</span>, <span class="fl">20</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">100</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span>(~<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">.</span>, <span class="fl">2</span>))

<span class="co"># Plot Relationship</span>
<span class="no">linear_data</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">macro_indicator</span>, <span class="no">sales</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.5</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"lm"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_dollar.html">dollar_format</a></span>(<span class="kw">scale</span> <span class="kw">=</span> <span class="fl">1e-6</span>, <span class="kw">suffix</span> <span class="kw">=</span> <span class="st">"M"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"Data with Linear Relationship"</span>)</pre></body></html></div>
<p><img src="key_considerations_files/figure-html/unnamed-chunk-3-1.png" width="60%" height="60%" style="display: block; margin: auto;"></p>
<p>We can see that the correlation between the two features is approximately 0.9.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">linear_data</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/correlate.html">correlate</a></span>(<span class="kw">target</span> <span class="kw">=</span> <span class="no">sales</span>)
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   feature         bin   correlation</span>
<span class="co">#&gt;   &lt;fct&gt;           &lt;chr&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt; 1 sales           &lt;NA&gt;        1    </span>
<span class="co">#&gt; 2 macro_indicator &lt;NA&gt;        0.918</span></pre></body></html></div>
<p>What happens when we <code><a href="../reference/binarize.html">binarize()</a></code>? What we want to know is which segment of the Macroeconomic Indicator is most correlated with the highest sales bin.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">linear_data_corr_tbl</span> <span class="kw">&lt;-</span> <span class="no">linear_data</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/binarize.html">binarize</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/correlate.html">correlate</a></span>(<span class="no">sales__150250005.6625_Inf</span>)

<span class="no">linear_data_corr_tbl</span>
<span class="co">#&gt; # A tibble: 8 x 3</span>
<span class="co">#&gt;   feature         bin                        correlation</span>
<span class="co">#&gt;   &lt;fct&gt;           &lt;chr&gt;                            &lt;dbl&gt;</span>
<span class="co">#&gt; 1 sales           150250005.6625_Inf               1    </span>
<span class="co">#&gt; 2 macro_indicator 17.635_Inf                       0.787</span>
<span class="co">#&gt; 3 sales           -Inf_50750010.5625              -0.333</span>
<span class="co">#&gt; 4 sales           50750010.5625_100500013.2       -0.333</span>
<span class="co">#&gt; 5 sales           100500013.2_150250005.6625      -0.333</span>
<span class="co">#&gt; 6 macro_indicator -Inf_9.5                        -0.333</span>
<span class="co">#&gt; 7 macro_indicator 9.5_12.175                      -0.333</span>
<span class="co">#&gt; 8 macro_indicator 12.175_17.635                   -0.12</span></pre></body></html></div>
<p>We can see that the best relationship between the highest sales bin is the highest macroeconomic indicator bin. The magnitude of the correlation is lower, but it’s still relatively high at approximately 0.8.</p>
<p>When we visualize with <code><a href="../reference/plot_correlation_funnel.html">plot_correlation_funnel()</a></code>, the macroeconomic predictor trend shows up indicating the highest macroeconomic indicator bin is highly correlated with the highest sales bin.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">linear_data_corr_tbl</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_correlation_funnel.html">plot_correlation_funnel</a></span>()</pre></body></html></div>
<p><img src="key_considerations_files/figure-html/unnamed-chunk-6-1.png" width="60%" height="60%" style="display: block; margin: auto;"></p>
</div>
<div id="non-linear-relationships" class="section level4">
<h4 class="hasAnchor">
<a href="#non-linear-relationships" class="anchor"></a>1.2 Non-Linear Relationships</h4>
<p>The real beauty of the binning process is when <strong><em>nonlinear trends</em></strong> are present. Let’s again make some synthetic data this time between sales and age of customer.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># Generate synthetic data</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)
<span class="no">nonlinear_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">tibble</a></span>(
  <span class="kw">sales</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">100</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">25</span>),
    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">100</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">50</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">100</span>),
    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">100</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">2</span>,  <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">40</span>)),
  <span class="kw">age</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
    <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="fl">100</span>, <span class="kw">min</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">max</span> <span class="kw">=</span> <span class="fl">29</span>),
    <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="fl">100</span>, <span class="kw">min</span> <span class="kw">=</span> <span class="fl">30</span>, <span class="kw">max</span> <span class="kw">=</span> <span class="fl">39</span>),
    <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="fl">100</span>, <span class="kw">min</span> <span class="kw">=</span> <span class="fl">39</span>, <span class="kw">max</span> <span class="kw">=</span> <span class="fl">59</span>)
  )
) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(
    <span class="kw">sales</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">sales</span> <span class="kw">&lt;</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="no">sales</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fl">2</span>),
    <span class="kw">age</span>   <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span>(<span class="no">age</span>)
    )

<span class="co"># Visualize the nonlinear relationship</span>
<span class="no">nonlinear_data</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">age</span>, <span class="no">sales</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.5</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"lm"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_dollar.html">dollar_format</a></span>()) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html">expand_limits</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="fl">300</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"Data with Non-Linear Relationship"</span>)</pre></body></html></div>
<p><img src="key_considerations_files/figure-html/unnamed-chunk-7-1.png" width="60%" height="60%" style="display: block; margin: auto;"></p>
<p>We can see that the age range between 30 and 37 has much larger sales than the other age ranges. However, a linear trendline is flat indicating essentially no linear relationship.</p>
<p>The correlation analysis on un-binned data similarly expresses the magnitude of the relationship at approximately 0.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">nonlinear_data</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/correlate.html">correlate</a></span>(<span class="no">sales</span>)
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   feature bin   correlation</span>
<span class="co">#&gt;   &lt;fct&gt;   &lt;chr&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt; 1 sales   &lt;NA&gt;       1.00  </span>
<span class="co">#&gt; 2 age     &lt;NA&gt;      -0.0459</span></pre></body></html></div>
<p>However, when we bin the data, the relationship is exposed. The bin age 31-36 has a 0.25 correlation, which is quite high for real data. This indicates predictive power. Below 25 at -0.18 is negatively correlated, and likewise above 46 is negatively correlated. This tells the story that the 30-36 age range is the most likely group to purchase products.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">nonlinear_data_corr_tbl</span> <span class="kw">&lt;-</span> <span class="no">nonlinear_data</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/binarize.html">binarize</a></span>(<span class="kw">n_bins</span> <span class="kw">=</span> <span class="fl">5</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/correlate.html">correlate</a></span>(<span class="no">sales__46.552_Inf</span>)

<span class="no">nonlinear_data_corr_tbl</span>
<span class="co">#&gt; # A tibble: 9 x 3</span>
<span class="co">#&gt;   feature bin                     correlation</span>
<span class="co">#&gt;   &lt;fct&gt;   &lt;chr&gt;                         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 sales   46.552_Inf                   1     </span>
<span class="co">#&gt; 2 sales   -Inf_5.07000000000002       -0.408 </span>
<span class="co">#&gt; 3 sales   5.07000000000002_23.936     -0.25  </span>
<span class="co">#&gt; 4 sales   23.936_46.552               -0.25  </span>
<span class="co">#&gt; 5 age     31_36                        0.246 </span>
<span class="co">#&gt; 6 age     -Inf_25                     -0.182 </span>
<span class="co">#&gt; 7 age     46_Inf                      -0.126 </span>
<span class="co">#&gt; 8 age     36_46                        0.0809</span>
<span class="co">#&gt; 9 age     25_31                       -0.0168</span></pre></body></html></div>
<p>We can confirm the relationship visually using <code><a href="../reference/plot_correlation_funnel.html">plot_correlation_funnel()</a></code>.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">nonlinear_data_corr_tbl</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_correlation_funnel.html">plot_correlation_funnel</a></span>(<span class="kw">limits</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.2</span>, <span class="fl">1</span>))</pre></body></html></div>
<p><img src="key_considerations_files/figure-html/unnamed-chunk-10-1.png" width="60%" height="60%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="what-about-skewed-numeric-data" class="section level3">
<h3 class="hasAnchor">
<a href="#what-about-skewed-numeric-data" class="anchor"></a>2. What About Skewed Numeric Data?</h3>
<p>Highly skewed numeric data is tricky because the binning strategy does not conform well to the traditional <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code> approach for cutting data into bins. One bin tends to dominate.</p>
<p>To get around this issue, the <code><a href="../reference/binarize.html">binarize()</a></code> function attempts to cut using the <code>n_bins</code> value provided by you.</p>
<p>When data becomes highly skewed, meaning one numeric value dominates so much that virtually all values are this value, the cuts are iteratively reduced until only 2 bins are left.</p>
<p>At that point the algorithm converts the values to factors, and anything that is not in the majority class gets a class of “OTHER” (or the value you provide as <code>name_infreq</code>).</p>
<p>We’ll show this process using skewed features in the <code>marketing_campaign_tbl</code> data that ships with <code>correlationfunnel</code>.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"marketing_campaign_tbl"</span>)

<span class="no">marketing_campaign_tbl</span>
<span class="co">#&gt; # A tibble: 45,211 x 18</span>
<span class="co">#&gt;    ID      AGE JOB   MARITAL EDUCATION DEFAULT BALANCE HOUSING LOAN  CONTACT</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  </span>
<span class="co">#&gt;  1 2836     58 mana… married tertiary  no         2143 yes     no    unknown</span>
<span class="co">#&gt;  2 2837     44 tech… single  secondary no           29 yes     no    unknown</span>
<span class="co">#&gt;  3 2838     33 entr… married secondary no            2 yes     yes   unknown</span>
<span class="co">#&gt;  4 2839     47 blue… married unknown   no         1506 yes     no    unknown</span>
<span class="co">#&gt;  5 2840     33 unkn… single  unknown   no            1 no      no    unknown</span>
<span class="co">#&gt;  6 2841     35 mana… married tertiary  no          231 yes     no    unknown</span>
<span class="co">#&gt;  7 2842     28 mana… single  tertiary  no          447 yes     yes   unknown</span>
<span class="co">#&gt;  8 2843     42 entr… divorc… tertiary  yes           2 yes     no    unknown</span>
<span class="co">#&gt;  9 2844     58 reti… married primary   no          121 yes     no    unknown</span>
<span class="co">#&gt; 10 2845     43 tech… single  secondary no          593 yes     no    unknown</span>
<span class="co">#&gt; # … with 45,201 more rows, and 8 more variables: DAY &lt;dbl&gt;, MONTH &lt;chr&gt;,</span>
<span class="co">#&gt; #   DURATION &lt;dbl&gt;, CAMPAIGN &lt;dbl&gt;, PDAYS &lt;dbl&gt;, PREVIOUS &lt;dbl&gt;,</span>
<span class="co">#&gt; #   POUTCOME &lt;chr&gt;, TERM_DEPOSIT &lt;chr&gt;</span></pre></body></html></div>
<div id="skewed-data" class="section level4">
<h4 class="hasAnchor">
<a href="#skewed-data" class="anchor"></a>2.1 Skewed Data</h4>
<p>The “CAMPAIGN” feature is skewed. It cannot be binned with 4 bins because the quantile has only 4 unique values (enough for 3 bins: 1-2, 2-3, 3-63).</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">marketing_campaign_tbl</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span>(<span class="no">CAMPAIGN</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>()
<span class="co">#&gt;   0%  25%  50%  75% 100% </span>
<span class="co">#&gt;    1    1    2    3   63</span></pre></body></html></div>
<p>We can see the skew visually.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">marketing_campaign_tbl</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">CAMPAIGN</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"Skewed Data"</span>)</pre></body></html></div>
<p><img src="key_considerations_files/figure-html/unnamed-chunk-13-1.png" width="60%" height="60%" style="display: block; margin: auto;"></p>
<p>We can see that <code><a href="../reference/binarize.html">binarize()</a></code> recognizes this and bins accordingly.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">marketing_campaign_tbl</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">CAMPAIGN</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/binarize.html">binarize</a></span>()
<span class="co">#&gt; # A tibble: 45,211 x 3</span>
<span class="co">#&gt;    `CAMPAIGN__-Inf_2` CAMPAIGN__2_3 CAMPAIGN__3_Inf</span>
<span class="co">#&gt;                 &lt;dbl&gt;         &lt;dbl&gt;           &lt;dbl&gt;</span>
<span class="co">#&gt;  1                  1             0               0</span>
<span class="co">#&gt;  2                  1             0               0</span>
<span class="co">#&gt;  3                  1             0               0</span>
<span class="co">#&gt;  4                  1             0               0</span>
<span class="co">#&gt;  5                  1             0               0</span>
<span class="co">#&gt;  6                  1             0               0</span>
<span class="co">#&gt;  7                  1             0               0</span>
<span class="co">#&gt;  8                  1             0               0</span>
<span class="co">#&gt;  9                  1             0               0</span>
<span class="co">#&gt; 10                  1             0               0</span>
<span class="co">#&gt; # … with 45,201 more rows</span></pre></body></html></div>
</div>
<div id="highly-skewed-data" class="section level4">
<h4 class="hasAnchor">
<a href="#highly-skewed-data" class="anchor"></a>2.2. Highly Skewed Data</h4>
<p>At some point, binning becomes impossible because only 2 values exist. Rather than drop the feature, <code><a href="../reference/binarize.html">binarize()</a></code> converts it to a <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> and the one-hot encoding process takes over using the <code>thresh_infreq</code> argument for converting any low frequency factors to a generic “OTHER” category.</p>
<p>We can see that the “PDAYS” feature is highly skewed with almost all values are <code>-1</code>.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">marketing_campaign_tbl</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span>(<span class="no">PDAYS</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>()
<span class="co">#&gt;   0%  25%  50%  75% 100% </span>
<span class="co">#&gt;   -1   -1   -1   -1  871</span></pre></body></html></div>
<p>We can see the high skew visually.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">marketing_campaign_tbl</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">PDAYS</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"Highly Skewed Data"</span>)</pre></body></html></div>
<p><img src="key_considerations_files/figure-html/unnamed-chunk-16-1.png" width="60%" height="60%" style="display: block; margin: auto;"></p>
<p>We can see that <code><a href="../reference/binarize.html">binarize()</a></code> converts this feature to categorical data then the categorical threshold takes over. Just specify the proportion of low frequency categories to retain.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">marketing_campaign_tbl</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">PDAYS</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/binarize.html">binarize</a></span>()
<span class="co">#&gt; # A tibble: 45,211 x 2</span>
<span class="co">#&gt;    `PDAYS__-1` `PDAYS__-OTHER`</span>
<span class="co">#&gt;          &lt;dbl&gt;           &lt;dbl&gt;</span>
<span class="co">#&gt;  1           1               0</span>
<span class="co">#&gt;  2           1               0</span>
<span class="co">#&gt;  3           1               0</span>
<span class="co">#&gt;  4           1               0</span>
<span class="co">#&gt;  5           1               0</span>
<span class="co">#&gt;  6           1               0</span>
<span class="co">#&gt;  7           1               0</span>
<span class="co">#&gt;  8           1               0</span>
<span class="co">#&gt;  9           1               0</span>
<span class="co">#&gt; 10           1               0</span>
<span class="co">#&gt; # … with 45,201 more rows</span></pre></body></html></div>
</div>
</div>
<div id="how-does-the-correlation-funnel-work-with-categorical-data" class="section level3">
<h3 class="hasAnchor">
<a href="#how-does-the-correlation-funnel-work-with-categorical-data" class="anchor"></a>3. How does the Correlation Funnel Work With Categorical Data?</h3>
<p>We’ve actually already seen this. The binarization processed when performed on numeric data converts the data to bins and then one-hot encodes the result. The bins are categories.</p>
<p>The process for categorical data works the same as for numeric (minus the binning process).</p>
<p>Let’s take a categorical feature from our <code>marketing_campaign_tbl</code>.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">marketing_campaign_tbl</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">EDUCATION</span>)
<span class="co">#&gt; # A tibble: 45,211 x 1</span>
<span class="co">#&gt;    EDUCATION</span>
<span class="co">#&gt;    &lt;chr&gt;    </span>
<span class="co">#&gt;  1 tertiary </span>
<span class="co">#&gt;  2 secondary</span>
<span class="co">#&gt;  3 secondary</span>
<span class="co">#&gt;  4 unknown  </span>
<span class="co">#&gt;  5 unknown  </span>
<span class="co">#&gt;  6 tertiary </span>
<span class="co">#&gt;  7 tertiary </span>
<span class="co">#&gt;  8 tertiary </span>
<span class="co">#&gt;  9 primary  </span>
<span class="co">#&gt; 10 secondary</span>
<span class="co">#&gt; # … with 45,201 more rows</span></pre></body></html></div>
<div id="one-hot-encoding-vs-dummy-encoding" class="section level4">
<h4 class="hasAnchor">
<a href="#one-hot-encoding-vs-dummy-encoding" class="anchor"></a>3.1 One-Hot Encoding vs Dummy Encoding</h4>
<p>The <code><a href="../reference/binarize.html">binarize()</a></code> function uses <strong><em>One-Hot Encoding</em></strong> by default. The Dummy Encoding Method has a key flaw for <em>Correlation Analysis</em> in that it does not show all of the categorical levels. This affects the <em>Correlation Funnel Plot</em> causing loss of potentially highly correlated bins in the visualization.</p>
<p><strong><em>One-Hot Encoding</em></strong> is the process of converting a categorical feature into a series of binary features. The default in <code><a href="../reference/binarize.html">binarize()</a></code> is to perform one-hot encoding, which returns the number of columns equal to the number of levels in the category. This creates a series of binary flags to use in the Correlation Analysis.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">marketing_campaign_tbl</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">EDUCATION</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/binarize.html">binarize</a></span>(<span class="kw">one_hot</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt; # A tibble: 45,211 x 4</span>
<span class="co">#&gt;    EDUCATION__primary EDUCATION__secondary EDUCATION__tertiary EDUCATION__unkno…</span>
<span class="co">#&gt;                 &lt;dbl&gt;                &lt;dbl&gt;               &lt;dbl&gt;             &lt;dbl&gt;</span>
<span class="co">#&gt;  1                  0                    0                   1                 0</span>
<span class="co">#&gt;  2                  0                    1                   0                 0</span>
<span class="co">#&gt;  3                  0                    1                   0                 0</span>
<span class="co">#&gt;  4                  0                    0                   0                 1</span>
<span class="co">#&gt;  5                  0                    0                   0                 1</span>
<span class="co">#&gt;  6                  0                    0                   1                 0</span>
<span class="co">#&gt;  7                  0                    0                   1                 0</span>
<span class="co">#&gt;  8                  0                    0                   1                 0</span>
<span class="co">#&gt;  9                  1                    0                   0                 0</span>
<span class="co">#&gt; 10                  0                    1                   0                 0</span>
<span class="co">#&gt; # … with 45,201 more rows</span></pre></body></html></div>
<p>Another popular method in statistical analysis is <strong><em>Dummy Encoding</em></strong>. The only real difference is that the number of columns are equal to the number of levels minus 1. When zeros are present in each of the new columns (secondary, tertiary, unknown) such as in Row 9, the value means not secondary, tertiary, or unknown, which in turn means primary.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">marketing_campaign_tbl</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">EDUCATION</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/binarize.html">binarize</a></span>(<span class="kw">one_hot</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co">#&gt; # A tibble: 45,211 x 3</span>
<span class="co">#&gt;    EDUCATION__secondary EDUCATION__tertiary EDUCATION__unknown</span>
<span class="co">#&gt;                   &lt;dbl&gt;               &lt;dbl&gt;              &lt;dbl&gt;</span>
<span class="co">#&gt;  1                    0                   1                  0</span>
<span class="co">#&gt;  2                    1                   0                  0</span>
<span class="co">#&gt;  3                    1                   0                  0</span>
<span class="co">#&gt;  4                    0                   0                  1</span>
<span class="co">#&gt;  5                    0                   0                  1</span>
<span class="co">#&gt;  6                    0                   1                  0</span>
<span class="co">#&gt;  7                    0                   1                  0</span>
<span class="co">#&gt;  8                    0                   1                  0</span>
<span class="co">#&gt;  9                    0                   0                  0</span>
<span class="co">#&gt; 10                    1                   0                  0</span>
<span class="co">#&gt; # … with 45,201 more rows</span></pre></body></html></div>
</div>
<div id="reducing-dimensionality-preventing-irrelevant-factor-levels" class="section level4">
<h4 class="hasAnchor">
<a href="#reducing-dimensionality-preventing-irrelevant-factor-levels" class="anchor"></a>3.2 Reducing Dimensionality (Preventing Irrelevant Factor Levels)</h4>
<p>The <code><a href="../reference/binarize.html">binarize()</a></code> function uses a parameter <code>thresh_infreq = 0.01</code> and <code>name_infreq = "OTHER"</code> to keep infrequent categories that add little value to the analysis from unnecessarily increasing dimensionality.</p>
<p><strong><em>Dimensionality Reduction</em></strong> is important for the correlation analysis. Categorical data can quickly get out of hand causing the width (number of columns) to increase, which is known as <strong><em>High Dimensionality</em></strong>. The <strong><em>One-Hot Encoding</em></strong> process will add a lot of features if not kept in check.</p>
<p>High Dimensionality is a two-fold problem. First, having many features adds to the computation time to analyze data. This is particularly painful on large data sets (5M rows+). Second, adding infrequent features (low occurrance) typically adds little predictive value to the modeling process.</p>
<p>To prevent this High Dimensionality situation, the <code><a href="../reference/binarize.html">binarize()</a></code> function contains a <code>thresh_infreq</code> argument that lumps infrequent categories together based on a threshold of proportion within the rows of the data. For example, a <code>thresh_infreq = 0.01</code> lumps any factors present in less than 1% of the data into a new category defined by <code>name_infreq = "-OTHER"</code> (you can change this name for the lumped category).</p>
<p>Let’s examine the “JOB” categorical feature from the <code>marketing_campaign_tbl</code>, which has 12 levels, one for the category of Job that the customer falls into. We can se that using <code><a href="../reference/binarize.html">binarize()</a></code> creates 12 new features.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">marketing_campaign_tbl</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">JOB</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/binarize.html">binarize</a></span>(<span class="kw">thresh_infreq</span> <span class="kw">=</span> <span class="fl">0</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>()
<span class="co">#&gt; Rows: 45,211</span>
<span class="co">#&gt; Columns: 12</span>
<span class="co">#&gt; $ JOB__admin.          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, …</span>
<span class="co">#&gt; $ `JOB__blue-collar`   &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span>
<span class="co">#&gt; $ JOB__entrepreneur    &lt;dbl&gt; 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, …</span>
<span class="co">#&gt; $ JOB__housemaid       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span>
<span class="co">#&gt; $ JOB__management      &lt;dbl&gt; 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span>
<span class="co">#&gt; $ JOB__retired         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, …</span>
<span class="co">#&gt; $ `JOB__self-employed` &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span>
<span class="co">#&gt; $ JOB__services        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, …</span>
<span class="co">#&gt; $ JOB__student         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span>
<span class="co">#&gt; $ JOB__technician      &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, …</span>
<span class="co">#&gt; $ JOB__unemployed      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span>
<span class="co">#&gt; $ JOB__unknown         &lt;dbl&gt; 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span></pre></body></html></div>
<p>Examining these features, not all are present frequenly. We can see that several features appear only 5% or less of the time.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">marketing_campaign_tbl</span> <span class="kw">%&gt;%</span>
  <span class="co"># Count Frequency</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span>(<span class="no">JOB</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">prop</span> <span class="kw">=</span> <span class="no">n</span> / <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">n</span>)) <span class="kw">%&gt;%</span>

  <span class="co"># Format columns for plot</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">JOB</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">JOB</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder</a></span>(<span class="no">n</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">label_text</span> <span class="kw">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span>(<span class="st">"JOB: {JOB}
                               Count: {n}
                               Prop: {scales::percent(prop)}"</span>)) <span class="kw">%&gt;%</span>

  <span class="co"># Creat viz</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">JOB</span>, <span class="no">n</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="no">n</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">yend</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">xend</span> <span class="kw">=</span> <span class="no">JOB</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">label</span> <span class="kw">=</span> <span class="no">label_text</span>), <span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">hjust</span> <span class="kw">=</span> <span class="st">"inward"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"Frequency of Each Level in JOB Feature"</span>)</pre></body></html></div>
<p><img src="key_considerations_files/figure-html/unnamed-chunk-22-1.png" width="60%" height="60%" style="display: block; margin: auto;"></p>
<p>We can reduce the dimensionality of this feature by increasing the grouping to 6% using <code>thresh_infreq = 0.06</code>. Now the features with presence less than 6% are grouped into an “-OTHER” category.</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">marketing_campaign_tbl</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">JOB</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/binarize.html">binarize</a></span>(<span class="kw">thresh_infreq</span> <span class="kw">=</span> <span class="fl">0.06</span>, <span class="kw">name_infreq</span> <span class="kw">=</span> <span class="st">"-OTHER"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>()
<span class="co">#&gt; Rows: 45,211</span>
<span class="co">#&gt; Columns: 6</span>
<span class="co">#&gt; $ JOB__admin.        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1,…</span>
<span class="co">#&gt; $ `JOB__blue-collar` &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…</span>
<span class="co">#&gt; $ JOB__management    &lt;dbl&gt; 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…</span>
<span class="co">#&gt; $ JOB__services      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,…</span>
<span class="co">#&gt; $ JOB__technician    &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0,…</span>
<span class="co">#&gt; $ `JOB__-OTHER`      &lt;dbl&gt; 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0,…</span></pre></body></html></div>
</div>
<div id="assessing-correlations-with-categorical-data" class="section level4">
<h4 class="hasAnchor">
<a href="#assessing-correlations-with-categorical-data" class="anchor"></a>3.3 Assessing Correlations With Categorical Data</h4>
<p>Once the data has been One-Hot Encoded, Correlation Analysis proceeds as normal.</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">marketing_campaign_tbl</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/binarize.html">binarize</a></span>(<span class="kw">n_bins</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">thresh_infreq</span> <span class="kw">=</span> <span class="fl">0.06</span>, <span class="kw">name_infreq</span> <span class="kw">=</span> <span class="st">"-OTHER"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/correlate.html">correlate</a></span>(<span class="no">TERM_DEPOSIT__yes</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_correlation_funnel.html">plot_correlation_funnel</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.7</span>)</pre></body></html></div>
<p><img src="key_considerations_files/figure-html/unnamed-chunk-24-1.png" width="60%" height="60%" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>[L. Duan et al., 2014] Lian Duan, W. Nick Street, Yanchi Liu, Songhua Xu, and Brook Wu. 2014. Selecting the right correlation measure for binary data. ACM Trans. Knowl. Discov. Data 9, 2, Article 13 (September 2014), 28 pages. DOI: <a href="http://dx.doi.org/10.1145/2637484" class="uri">http://dx.doi.org/10.1145/2637484</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matt Dancho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
